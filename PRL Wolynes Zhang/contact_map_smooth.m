
%
clear all;
addpath('/Users/bz12/Program/matlab/gridfitdir');
%
%
load '../contact_probability_normalized_by_individual_mid/contact_probability_normalized_by_individual.mat';

nbeads = size(cp, 1);
nEigs = 400;

xl = 1:nbeads; yl = 1:nbeads;
[xgrid, ygrid] = meshgrid(xl, yl);
xi = reshape(xgrid, nbeads*nbeads,1);
yi = reshape(ygrid, nbeads*nbeads,1);
zi = reshape(cp, nbeads*nbeads,1);

cp = gridfit(xi,yi,zi, xgrid(1,:), ygrid(:,1), 'smoothness', 10);

optInd = cp > 1.0;
cp(optInd) = 1.0;

figure(1); clf;  
set(gcf, 'Colormap',...
    [1 1 1;1 1 0.666666686534882;1 1 0.333333343267441;1 1 0;1 0.972972989082336 0;1 0.945945918560028 0;1 0.918918907642365 0;1 0.891891896724701 0;1 0.864864885807037 0;1 0.837837815284729 0;1 0.810810804367065 0;1 0.783783793449402 0;1 0.756756782531738 0;1 0.72972971200943 0;1 0.702702701091766 0;1 0.675675690174103 0;1 0.648648619651794 0;1 0.621621608734131 0;1 0.594594597816467 0;1 0.567567586898804 0;1 0.540540516376495 0;1 0.513513505458832 0;1 0.486486494541168 0;1 0.459459453821182 0;1 0.432432442903519 0;1 0.405405402183533 0;1 0.378378391265869 0;1 0.351351350545883 0;1 0.324324309825897 0;1 0.297297298908234 0;1 0.270270258188248 0;1 0.243243247270584 0;1 0.216216221451759 0;1 0.189189195632935 0;1 0.162162154912949 0;1 0.135135129094124 0;1 0.10810811072588 0;1 0.0810810774564743 0;1 0.0540540553629398 0;1 0.0270270276814699 0;1 0 0;0.958333313465118 0 0;0.916666686534882 0 0;0.875 0 0;0.833333313465118 0 0;0.791666686534882 0 0;0.75 0 0;0.708333313465118 0 0;0.666666686534882 0 0;0.625 0 0;0.583333313465118 0 0;0.541666686534882 0 0;0.5 0 0;0.458333343267441 0 0;0.416666656732559 0 0;0.375 0 0;0.333333343267441 0 0;0.291666656732559 0 0;0.25 0 0;0.20833332836628 0 0;0.16666667163372 0 0;0.125 0 0;0.0833333358168602 0 0;0.0416666679084301 0 0]);

imagesc(xl, fliplr(yl), cp);

set(gca, 'clim', [0, 1.0])
%
%
xtickl = 100; xtickr = 800;
set(gca,'position',[0.1300    0.1100    0.7750    0.8150], 'linewidth', 2)
set(gca, 'fontsize',25, 'xtick', xtickl:100:xtickr, 'ytick', (nbeads-xtickr):100:(nbeads-xtickl), 'xticklabel', 10:10:80, 'yticklabel', fliplr(10:10:80))

%
% save matrix
save contact_probability_smoothed.mat cp